import{j as e}from"./ui-core-ChrqsUrC-1758044137647.js";import{r as t}from"./react-vendor-BrSRjOqW-1758044137647.js";import{H as r}from"./index-Cttt-HEy-1758044137647.js";import{p as s}from"./personalSubscriptionShareService-CSC8Wb4n-1758044137647.js";import"./utils-DdJ5UvfL-1758044137647.js";import"./vendor-misc-DVwJBo1j-1758044137647.js";import"./query-oJX1HcLJ-1758044137647.js";import"./router-B1EXW9fX-1758044137647.js";import"./ui-extended-Czht78rK-1758044137647.js";const a=()=>{const[a,o]=t.useState([]),[i,c]=t.useState(!1),[l,d]=t.useState("https://wechat-debug-api.vee5208.workers.dev"),m=(e,t,r)=>{const s={type:e,timestamp:(new Date).toLocaleTimeString(),message:t,data:r};o(e=>[...e.slice(-49),s])},p=async()=>{try{const e=window.location.href,t=await fetch(`${l}/api/wechat/signature?url=${encodeURIComponent(e)}&debug=true`),r=await t.json();if(r.error)return void m("error","âŒ è·å–å¾®ä¿¡é…ç½®å¤±è´¥",r);const s=window.wx;m("info","ğŸ”§ é…ç½®å¾®ä¿¡JS-SDK...",{appId:r.appId,timestamp:r.timestamp,hasSignature:!!r.signature}),s.config({debug:!0,appId:r.appId,timestamp:r.timestamp,nonceStr:r.nonceStr,signature:r.signature,jsApiList:r.jsApiList}),s.ready(()=>{m("success","âœ… å¾®ä¿¡JS-SDKé…ç½®æˆåŠŸï¼å¯ä»¥ä½¿ç”¨åˆ†äº«åŠŸèƒ½")}),s.error(e=>{m("error","âŒ å¾®ä¿¡JS-SDKé…ç½®å¤±è´¥",e)})}catch(e){m("error","âŒ å¾®ä¿¡SDKæµ‹è¯•å¤±è´¥",{error:e.message})}};return t.useEffect(()=>{m("info","ğŸš€ å¾®ä¿¡åˆ†äº«è°ƒè¯•é¡µé¢å·²åŠ è½½"),m("info","ğŸ“± ç”¨æˆ·ä»£ç†",{userAgent:navigator.userAgent}),m("info","ğŸŒ å½“å‰URL",{url:window.location.href}),m("info","ğŸ“± æ˜¯å¦å¾®ä¿¡ç¯å¢ƒ",{isWeChat:/micromessenger/i.test(navigator.userAgent)})},[]),e.jsxs(e.Fragment,{children:[e.jsxs(r,{children:[e.jsx("title",{children:"å¾®ä¿¡åˆ†äº«è°ƒè¯• - AIæ¨æµ‹è¯•ç«™"}),e.jsx("meta",{name:"description",content:"å¾®ä¿¡åˆ†äº«åŠŸèƒ½è°ƒè¯•å’Œç›‘æ§é¡µé¢ï¼Œç”¨äºæµ‹è¯•ä¸ªäººè®¢é˜…å·çš„åˆ†äº«é…ç½®ã€‚"}),e.jsx("meta",{property:"og:title",content:"å¾®ä¿¡åˆ†äº«è°ƒè¯• - AIæ¨æµ‹è¯•ç«™"}),e.jsx("meta",{property:"og:description",content:"å¾®ä¿¡åˆ†äº«åŠŸèƒ½è°ƒè¯•å’Œç›‘æ§é¡µé¢ï¼Œç”¨äºæµ‹è¯•ä¸ªäººè®¢é˜…å·çš„åˆ†äº«é…ç½®ã€‚"}),e.jsx("meta",{property:"og:image",content:"https://news.aipush.fun/wechat-share-300.png"}),e.jsx("meta",{property:"og:url",content:window.location.href})]}),e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"ğŸ”§ å¾®ä¿¡åˆ†äº«è°ƒè¯•æµ‹è¯•ç«™"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Worker APIåœ°å€:"}),e.jsx("input",{type:"text",value:l,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-6",children:[e.jsx("button",{onClick:async()=>{c(!0),m("info","ğŸ”„ å¼€å§‹æµ‹è¯•Worker API...");try{const e=await fetch(`${l}/api/wechat/status`),t=await e.json();m("success","âœ… WorkerçŠ¶æ€æ£€æŸ¥æˆåŠŸ",t);const r=window.location.href,s=await fetch(`${l}/api/wechat/signature?url=${encodeURIComponent(r)}&debug=true`),a=await s.json();a.error?m("error","âŒ ç­¾åç”Ÿæˆå¤±è´¥",a):m("success","âœ… ç­¾åç”ŸæˆæˆåŠŸ",{appId:a.appId,timestamp:a.timestamp,hasSignature:!!a.signature,signatureLength:a.signature?.length||0})}catch(e){m("error","âŒ APIæµ‹è¯•å¤±è´¥",{error:e.message})}c(!1)},disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:i?"æµ‹è¯•ä¸­...":"æµ‹è¯•Worker API"}),e.jsx("button",{onClick:async()=>{if(m("info","ğŸ”„ æµ‹è¯•å¾®ä¿¡JS-SDK..."),void 0===window.wx){m("warning","âš ï¸ å¾®ä¿¡JS-SDKæœªåŠ è½½ï¼Œæ­£åœ¨åŠ è½½...");const e=document.createElement("script");e.src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js",e.onload=()=>{m("success","âœ… å¾®ä¿¡JS-SDKåŠ è½½å®Œæˆ"),p()},e.onerror=()=>{m("error","âŒ å¾®ä¿¡JS-SDKåŠ è½½å¤±è´¥")},document.head.appendChild(e)}else p()},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"æµ‹è¯•å¾®ä¿¡JS-SDK"}),e.jsx("button",{onClick:()=>{m("info","ğŸ”„ æµ‹è¯•Metaæ ‡ç­¾åˆ†äº«æ–¹æ¡ˆ...");const e={title:"å¾®ä¿¡åˆ†äº«æµ‹è¯• - AIæ¨",desc:"è¿™æ˜¯ä¸€ä¸ªå¾®ä¿¡åˆ†äº«åŠŸèƒ½çš„æµ‹è¯•é¡µé¢ï¼Œç”¨äºéªŒè¯ä¸ªäººè®¢é˜…å·çš„åˆ†äº«é…ç½®ã€‚",link:window.location.href,imgUrl:"https://news.aipush.fun/wechat-share-300.png"};try{s.configureShare(e),m("success","âœ… Metaæ ‡ç­¾åˆ†äº«é…ç½®å®Œæˆ",e);const t={};document.querySelectorAll('meta[property^="og:"], meta[name^="twitter:"]').forEach(e=>{const r=e.getAttribute("property")||e.getAttribute("name"),s=e.getAttribute("content");r&&s&&(t[r]=s)}),m("info","ğŸ“‹ å½“å‰é¡µé¢Metaæ ‡ç­¾",t)}catch(t){m("error","âŒ Metaæ ‡ç­¾é…ç½®å¤±è´¥",{error:t.message})}},className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"æµ‹è¯•Metaæ ‡ç­¾åˆ†äº«"}),e.jsx("button",{onClick:async()=>{try{const e=await fetch(`${l}/debug/logs?limit=10`),t=await e.json();m("info","ğŸ“‹ Workerè°ƒè¯•æ—¥å¿—",t)}catch(e){m("error","âŒ åŠ è½½Workeræ—¥å¿—å¤±è´¥",{error:e.message})}},className:"px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700",children:"æŸ¥çœ‹Workeræ—¥å¿—"}),e.jsx("button",{onClick:()=>{o([]),m("info","ğŸ—‘ï¸ æœ¬åœ°æ—¥å¿—å·²æ¸…é™¤")},className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"æ¸…é™¤æ—¥å¿—"})]}),e.jsxs("div",{className:"bg-gray-900 text-gray-100 rounded-lg p-4 h-96 overflow-y-auto font-mono text-sm",children:[e.jsxs("div",{className:"mb-2 text-gray-400",children:["=== è°ƒè¯•æ—¥å¿— (æœ€è¿‘",a.length,"æ¡) ==="]}),a.map((t,r)=>e.jsxs("div",{className:`mb-1 ${n(t.type)}`,children:[e.jsxs("span",{className:"text-gray-400",children:["[",t.timestamp,"]"]})," ",e.jsx("span",{className:"text-white",children:t.message}),t.data&&e.jsx("div",{className:"mt-1 ml-4 text-gray-300 whitespace-pre-wrap",children:"string"==typeof t.data?t.data:JSON.stringify(t.data,null,2)})]},r)),0===a.length&&e.jsx("div",{className:"text-gray-400",children:"æš‚æ— æ—¥å¿—è®°å½•..."})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"ğŸ“– ä½¿ç”¨è¯´æ˜:"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ åœ¨å¾®ä¿¡ä¸­æ‰“å¼€æ­¤é¡µé¢è¿›è¡Œæµ‹è¯•"}),e.jsx("li",{children:"â€¢ ç‚¹å‡»å„ç§æµ‹è¯•æŒ‰é’®æŸ¥çœ‹è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯"}),e.jsx("li",{children:"â€¢ Workeræ—¥å¿—ä¼šè®°å½•æ‰€æœ‰APIè°ƒç”¨å’Œå“åº”"}),e.jsx("li",{children:"â€¢ åˆ†äº«æ—¶æŸ¥çœ‹æ§åˆ¶å°å’Œæ—¥å¿—äº†è§£è¯¦ç»†è¿‡ç¨‹"})]})]})]})})})]})};function n(e){switch(e){case"error":return"text-red-400";case"success":return"text-green-400";case"warning":return"text-yellow-400";case"info":return"text-blue-400";default:return"text-gray-300"}}export{a as WeChatDebugPage};
