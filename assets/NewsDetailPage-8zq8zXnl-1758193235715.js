var e=Object.defineProperty,t=(t,n,s)=>((t,n,s)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s)(t,"symbol"!=typeof n?n+"":n,s);import{j as n}from"./ui-core-C0AY41-a-1758193235715.js";import{r as s}from"./react-vendor-BrSRjOqW-1758193235715.js";import{u as i,a,B as o,b as r,C as c,c as l,d,g as h,H as m,i as x}from"./index-CGU5putU-1758193235715.js";import{S as p}from"./separator-q__AhvuI-1758193235715.js";import{A as g,b as f,E as u,C as w,n as y,o as b,h as j}from"./vendor-misc-B3nL6pMb-1758193235715.js";import{p as v}from"./personalSubscriptionShareService-CSC8Wb4n-1758193235715.js";import{c as C,u as N}from"./router-3EP_-Xcd-1758193235715.js";import"./utils-DdJ5UvfL-1758193235715.js";import"./query-CSD4r2F1-1758193235715.js";import"./ui-extended-BlqqW-_--1758193235715.js";const k=class e{constructor(){t(this,"canvas"),t(this,"ctx"),t(this,"templateConfig",{width:750,height:1334,backgroundColor:"#f5f5f5",textColor:"#333333",dateColor:"#666666",authorColor:"#666666",padding:40,qrSize:100}),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}static getInstance(){return e.instance||(e.instance=new e),e.instance}async generateSimplePoster(e){const t=this.templateConfig;this.canvas.width=t.width,this.canvas.height=t.height,this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high";try{return this.drawBackground(),this.drawDate(e.publishedAt),this.drawTitle(e.title),this.drawAuthor(e.source),await this.drawQRCodeArea(e.id),this.drawBrandLogo(),this.canvas.toDataURL("image/png",1)}catch(n){throw new Error("æµ·æŠ¥ç”Ÿæˆå¤±è´¥")}}drawBackground(){const{width:e,height:t,backgroundColor:n}=this.templateConfig;this.ctx.fillStyle=n,this.ctx.fillRect(0,0,e,t)}drawDate(e){const{padding:t,dateColor:n}=this.templateConfig;let s="08/06";if(e){const t=new Date(e);s=`${String(t.getMonth()+1).padStart(2,"0")}/${String(t.getDate()).padStart(2,"0")}`}this.ctx.fillStyle=n,this.ctx.font='bold 80px -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif',this.ctx.textAlign="left",this.ctx.fillText(s.split("/")[0],t,t+80),this.ctx.fillStyle="#333333",this.ctx.fillRect(t,t+100,80,4),this.ctx.fillStyle=n,this.ctx.fillText(s.split("/")[1],t,t+160)}drawTitle(e){const{width:t,padding:n,textColor:s}=this.templateConfig;this.ctx.fillStyle=s,this.ctx.font='bold 48px "Microsoft YaHei", "PingFang SC", sans-serif',this.ctx.textAlign="left";const i=t-2*n,a=this.wrapText(e,i);a.slice(0,4).forEach((e,t)=>{this.ctx.fillText(e,n,350+65*t)})}drawAuthor(e){const{padding:t,authorColor:n}=this.templateConfig;this.ctx.fillStyle=n,this.ctx.font='28px "Microsoft YaHei", sans-serif',this.ctx.textAlign="left";const s=e||"AIæ¨-ä¸“æ³¨AIç§‘æŠ€æ–°é—»";this.ctx.fillText(s,t,680)}async drawQRCodeArea(e){const{width:t,padding:n,qrSize:s}=this.templateConfig,i=950,a=n;let o;o="undefined"!=typeof window&&window.location?window.location.href:`https://news.aipush.fun/#/news/${e}`;const r=[`https://api.qrserver.com/v1/create-qr-code/?size=${s}x${s}&data=${encodeURIComponent(o)}&format=png&margin=1&ecc=H&color=000000&bgcolor=ffffff`,`https://quickchart.io/qr?text=${encodeURIComponent(o)}&size=${s}&format=png&ecLevel=H&margin=1&dark=000000&light=ffffff`,`https://chart.googleapis.com/chart?chs=${s}x${s}&cht=qr&chl=${encodeURIComponent(o)}&choe=UTF-8&chld=H|1`];let c=!1;for(const h of r)try{const e=await this.loadImageWithTimeout(h,5e3);this.ctx.drawImage(e,a,i,s,s),c=!0;break}catch(d){continue}c||this.drawQRPlaceholder(a,i,s),this.ctx.fillStyle="#666666",this.ctx.font='24px "Microsoft YaHei", sans-serif',this.ctx.textAlign="left";const l=a+s+20;this.ctx.fillText("é•¿æŒ‰è¯†åˆ«äºŒç»´ç ",l,985),this.ctx.fillText("é˜…è¯»æ–‡ç« ",l,1020)}drawQRPlaceholder(e,t,n){this.ctx.fillStyle="#ffffff",this.ctx.fillRect(e,t,n,n),this.ctx.strokeStyle="#000000",this.ctx.lineWidth=2,this.ctx.strokeRect(e,t,n,n),this.ctx.fillStyle="#000000";const s=n/21;this.drawFinderPattern(e+s,t+s,7*s),this.drawFinderPattern(e+13*s,t+s,7*s),this.drawFinderPattern(e+s,t+13*s,7*s);for(let i=9;i<12;i++)for(let n=9;n<12;n++)(i+n)%2==0&&this.ctx.fillRect(e+n*s,t+i*s,s,s)}drawFinderPattern(e,t,n){const s=n/7;this.ctx.fillRect(e,t,n,n),this.ctx.fillStyle="#ffffff",this.ctx.fillRect(e+s,t+s,5*s,5*s),this.ctx.fillStyle="#000000",this.ctx.fillRect(e+2*s,t+2*s,3*s,3*s)}drawBrandLogo(){const{width:e,height:t}=this.templateConfig;this.ctx.fillStyle="#ff4757",this.ctx.fillRect(e-160,t-100,140,80),this.ctx.fillStyle="#ffffff",this.ctx.font='bold 20px "Microsoft YaHei", sans-serif',this.ctx.textAlign="center",this.ctx.fillText("AIæ¨",e-90,t-70),this.ctx.font='12px "Microsoft YaHei", sans-serif',this.ctx.fillText("news.aipush.fun",e-90,t-45)}wrapText(e,t){const n=e.split(""),s=[];let i="";for(const a of n){const e=i+a;this.ctx.measureText(e).width>t&&""!==i?(s.push(i),i=a):i=e}return i&&s.push(i),s}loadImageWithTimeout(e,t=5e3){return new Promise((n,s)=>{const i=new Image;i.crossOrigin="anonymous";const a=setTimeout(()=>{s(new Error("å›¾ç‰‡åŠ è½½è¶…æ—¶"))},t);i.onload=()=>{clearTimeout(a),n(i)},i.onerror=()=>{clearTimeout(a),s(new Error("å›¾ç‰‡åŠ è½½å¤±è´¥"))},i.src=e})}downloadPoster(e,t="news-poster.png"){const n=document.createElement("a");n.download=t,n.href=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}};t(k,"instance");const T=k.getInstance(),S=class e{constructor(){t(this,"canvas"),t(this,"ctx"),t(this,"templateImage",null),t(this,"config",{width:800,height:1280,titleArea:{x:80,y:130,width:640,maxLines:2,fontSize:36,fontFamily:'"Microsoft YaHei", "PingFang SC", sans-serif',fontWeight:"bold",color:"#ffffff",lineHeight:50,textAlign:"center"},contentArea:{x:120,y:320,width:560,height:400,maxLines:10,fontSize:32,fontFamily:'"Microsoft YaHei", "PingFang SC", sans-serif',fontWeight:"normal",color:"#333333",lineHeight:45,textAlign:"left"},qrCodeArea:{x:192,y:1120,size:150}}),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}static getInstance(){return e.instance||(e.instance=new e),e.instance}async generateShareImage(e){try{return await this.loadAndDrawTemplate(),this.drawTitle(e.title),this.drawContent(e.content),await this.drawQRCode(e.id),this.canvas.toDataURL("image/jpeg",.9)}catch(t){throw new Error("åˆ†äº«å›¾ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•")}}async loadAndDrawTemplate(){this.templateImage||(this.templateImage=await this.loadImageWithTimeout("/share-template-blank.jpg",1e4)),this.canvas.width=this.templateImage.width,this.canvas.height=this.templateImage.height,this.config.width=this.templateImage.width,this.config.height=this.templateImage.height,this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high",this.ctx.drawImage(this.templateImage,0,0)}drawTitle(e){const{titleArea:t}=this.config;this.ctx.fillStyle=t.color,this.ctx.font=`${t.fontWeight} ${t.fontSize}px ${t.fontFamily}`,this.ctx.textAlign=t.textAlign,this.ctx.textBaseline="top";const n=this.wrapText(e,t.width),s=Math.min(n.length,t.maxLines),i=this.config.width/2,a=t.y;for(let o=0;o<s;o++){const e=a+o*t.lineHeight;this.ctx.fillText(n[o],i,e)}}drawContent(e){const{contentArea:t}=this.config;this.ctx.fillStyle=t.color,this.ctx.font=`${t.fontWeight} ${t.fontSize}px ${t.fontFamily}`,this.ctx.textAlign=t.textAlign,this.ctx.textBaseline="top";let n=e;e.length>180&&(n=e.substring(0,180)+"...");const s=this.wrapText(n,t.width),i=Math.min(s.length,t.maxLines);for(let a=0;a<i;a++){const e=t.y+a*t.lineHeight;this.ctx.fillText(s[a],t.x,e)}}async drawQRCode(e){const{qrCodeArea:t}=this.config;let n;n="undefined"!=typeof window&&window.location?window.location.href:`https://news.aipush.fun/#/news/${e}`;const s=[`https://api.qrserver.com/v1/create-qr-code/?size=${t.size}x${t.size}&data=${encodeURIComponent(n)}&format=png&margin=1&ecc=H&color=000000&bgcolor=ffffff`,`https://quickchart.io/qr?text=${encodeURIComponent(n)}&size=${t.size}&format=png&ecLevel=H&margin=1&dark=000000&light=ffffff`,`https://chart.googleapis.com/chart?chs=${t.size}x${t.size}&cht=qr&chl=${encodeURIComponent(n)}&choe=UTF-8&chld=H|1`];let i=!1;for(const o of s)try{const e=await this.loadImageWithTimeout(o,5e3),n=t.x-t.size/2,s=t.y-t.size/2;this.ctx.drawImage(e,n,s,t.size,t.size),i=!0;break}catch(a){continue}i||this.drawQRCodePlaceholder()}drawQRCodePlaceholder(){const{qrCodeArea:e}=this.config,t=e.x-e.size/2,n=e.y-e.size/2;this.ctx.fillStyle="#ffffff",this.ctx.fillRect(t,n,e.size,e.size),this.ctx.strokeStyle="#000000",this.ctx.lineWidth=2,this.ctx.strokeRect(t,n,e.size,e.size),this.ctx.fillStyle="#666666",this.ctx.font='bold 20px "Microsoft YaHei"',this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText("äºŒç»´ç ",e.x,e.y)}wrapText(e,t){const n=[];let s="";for(let i=0;i<e.length;i++){const a=s+e[i];this.ctx.measureText(a).width>t&&""!==s?(n.push(s),s=e[i]):s=a}return s&&n.push(s),n}loadImageWithTimeout(e,t=5e3){return new Promise((n,s)=>{const i=new Image;i.crossOrigin="anonymous";const a=setTimeout(()=>{s(new Error("å›¾ç‰‡åŠ è½½è¶…æ—¶"))},t);i.onload=()=>{clearTimeout(a),n(i)},i.onerror=()=>{clearTimeout(a),s(new Error("å›¾ç‰‡åŠ è½½å¤±è´¥"))},i.src=e})}downloadShareImage(e,t="ai-news-share.jpg"){const n=document.createElement("a");n.download=t,n.href=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}};t(S,"instance");const E=S.getInstance(),A=({id:e,title:t,content:h,imageUrl:m,source:x,publishedAt:j,category:v,originalUrl:C,aiInsight:N,isTranslatedContent:k,onBack:S})=>{const{isZh:A}=i();a();const[I,z]=s.useState(!1),[F,$]=s.useState(!1),R=t,B=(e=>{if(!e)return A?"æ­£æ–‡å†…å®¹è·å–ä¸­...":"Content loading...";if(e.length<200){return e+(A?'\n\nğŸ“ å†…å®¹è¾ƒçŸ­ï¼Œå¯èƒ½ä¸ºæ‘˜è¦ã€‚ç‚¹å‡»ä¸‹æ–¹"æŸ¥çœ‹åŸæ–‡"è·å–å®Œæ•´å†…å®¹ã€‚':'\n\nğŸ“ Content may be abbreviated. Click "View Original" below for complete article.')}if(e.endsWith("...")||e.endsWith("â€¦")||e.includes("ä»¥ä¸‹æ˜¯")||e.includes("The following is")){return e+(A?"\n\nğŸ”— å†…å®¹å¯èƒ½ä¸å®Œæ•´ï¼Œå»ºè®®æŸ¥çœ‹åŸå§‹æ–‡ç« è·å–å®Œæ•´ä¿¡æ¯ã€‚":"\n\nğŸ”— Content may be incomplete. Please check the original article for full information.")}return e})(h),P=e=>{try{const t=new Date(e);if(isNaN(t.getTime()))return"æ—¶é—´æœªçŸ¥";const n=t.getUTCFullYear(),s=t.getUTCMonth(),i=t.getUTCDate(),a=t.getUTCHours(),o=t.getUTCMinutes();return new Date(n,s,i,a,o).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return"æ—¶é—´æœªçŸ¥"}},D=async()=>{const e=window.location.href,n=`${t} - æ¥è‡ªAIæ¨è¶£æ–°é—»`;if(/micromessenger/i.test(navigator.userAgent))L(e);else if(navigator.share)try{await navigator.share({title:n,text:h.substring(0,100)+"...",url:e})}catch(s){}else navigator.clipboard&&(await navigator.clipboard.writeText(e),alert("é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼"))},U=(e,t)=>{const n=document.createElement("div");n.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0,0,0,0.8);\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      z-index: 10000;\n    ";const s=document.createElement("div");s.style.cssText="\n      background: white;\n      padding: 20px;\n      border-radius: 10px;\n      max-width: 90%;\n      max-height: 90%;\n      text-align: center;\n      overflow: auto;\n    ";const i=document.createElement("div");i.style.cssText="\n      margin-bottom: 15px;\n      color: #28a745;\n      font-weight: bold;\n      font-size: 18px;\n    ",i.textContent="âœ… æµ·æŠ¥ç”ŸæˆæˆåŠŸï¼";const a=document.createElement("img");a.src=e,a.style.cssText="\n      max-width: 100%;\n      height: auto;\n      margin: 15px 0;\n      border-radius: 8px;\n      box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n    ";const o=document.createElement("div");o.style.cssText="\n      display: flex;\n      gap: 10px;\n      justify-content: center;\n      margin-top: 15px;\n    ";const r=document.createElement("button");r.textContent="ğŸ’¾ ä¿å­˜å›¾ç‰‡",r.style.cssText="\n      padding: 10px 20px;\n      background: #007AFF;\n      color: white;\n      border: none;\n      border-radius: 5px;\n      cursor: pointer;\n      font-weight: bold;\n    ",r.onclick=()=>{T.downloadPoster(e,`${t.title.substring(0,20)}.png`)};const c=document.createElement("button");c.textContent="âŒ å…³é—­",c.style.cssText="\n      padding: 10px 20px;\n      background: #6c757d;\n      color: white;\n      border: none;\n      border-radius: 5px;\n      cursor: pointer;\n      font-weight: bold;\n    ",c.onclick=()=>{document.body.removeChild(n)},o.appendChild(r),o.appendChild(c),s.appendChild(i),s.appendChild(a),s.appendChild(o),n.appendChild(s),document.body.appendChild(n),n.onclick=e=>{e.target===n&&document.body.removeChild(n)}},H=(e,t)=>{const n=document.createElement("div");n.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0,0,0,0.8);\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      z-index: 10000;\n    ";const s=document.createElement("div");s.style.cssText="\n      background: white;\n      padding: 20px;\n      border-radius: 10px;\n      max-width: 90%;\n      max-height: 90%;\n      text-align: center;\n      overflow: auto;\n    ";const i=document.createElement("div");i.style.cssText="\n      margin-bottom: 15px;\n      color: #4A90E2;\n      font-weight: bold;\n      font-size: 18px;\n    ",i.textContent="âœ… ç²¾ç¾åˆ†äº«å›¾ç”ŸæˆæˆåŠŸï¼";const a=document.createElement("img");a.src=e,a.style.cssText="\n      max-width: 100%;\n      height: auto;\n      margin: 15px 0;\n      border-radius: 8px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.2);\n    ";const o=document.createElement("div");o.style.cssText="\n      display: flex;\n      gap: 10px;\n      justify-content: center;\n      margin-top: 20px;\n    ";const r=document.createElement("button");r.textContent="ğŸ’¾ ä¸‹è½½åˆ†äº«å›¾",r.style.cssText="\n      padding: 12px 24px;\n      background: linear-gradient(45deg, #4A90E2, #357ABD);\n      color: white;\n      border: none;\n      border-radius: 8px;\n      cursor: pointer;\n      font-weight: bold;\n      font-size: 14px;\n    ",r.onclick=()=>{E.downloadShareImage(e,`${t.title.substring(0,20)}-åˆ†äº«å›¾.jpg`)};const c=document.createElement("button");c.textContent="âŒ å…³é—­",c.style.cssText="\n      padding: 12px 24px;\n      background: #6c757d;\n      color: white;\n      border: none;\n      border-radius: 8px;\n      cursor: pointer;\n      font-weight: bold;\n      font-size: 14px;\n    ",c.onclick=()=>{document.body.removeChild(n)},o.appendChild(r),o.appendChild(c),s.appendChild(i),s.appendChild(a),s.appendChild(o),n.appendChild(s),document.body.appendChild(n),n.onclick=e=>{e.target===n&&document.body.removeChild(n)}},L=(t,n)=>{const s=document.createElement("div");s.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.8);\n      z-index: 9999;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', sans-serif;\n    ";const i=document.createElement("div");i.style.cssText="\n      background: white;\n      border-radius: 16px;\n      padding: 24px;\n      margin: 20px;\n      max-width: 350px;\n      text-align: center;\n      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n      position: relative;\n    ",i.innerHTML='\n      <h3 style="margin: 0 0 20px 0; color: #1D1D1F; font-size: 20px; font-weight: 600;">é€‰æ‹©åˆ†äº«æ–¹å¼</h3>\n\n      <div style="display: flex; flex-direction: column; gap: 12px;">\n        <button id="posterShareBtn" style="\n          background: linear-gradient(135deg, #007AFF 0%, #AF52DE 100%);\n          color: white;\n          border: none;\n          border-radius: 12px;\n          padding: 16px;\n          font-size: 16px;\n          font-weight: 500;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          gap: 8px;\n          transition: transform 0.2s;\n        " onmouseover="this.style.transform=\'scale(1.02)\'" onmouseout="this.style.transform=\'scale(1)\'">\n          <span style="font-size: 18px;">ğŸ¨</span>\n          ç”Ÿæˆæµ·æŠ¥åˆ†äº« (æ¨è)\n        </button>\n\n        <button id="templateShareBtn" style="\n          background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);\n          color: white;\n          border: none;\n          border-radius: 12px;\n          padding: 16px;\n          font-size: 16px;\n          font-weight: 500;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          gap: 8px;\n          transition: transform 0.2s;\n        " onmouseover="this.style.transform=\'scale(1.02)\'" onmouseout="this.style.transform=\'scale(1)\'">\n          <span style="font-size: 18px;">ğŸ–¼ï¸</span>\n          ç²¾ç¾æ¨¡æ¿åˆ†äº«å›¾\n        </button>\n\n        <button id="linkShareBtn" style="\n          background: #F2F2F7;\n          color: #1D1D1F;\n          border: 1px solid #E5E5EA;\n          border-radius: 12px;\n          padding: 16px;\n          font-size: 16px;\n          font-weight: 500;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          gap: 8px;\n          transition: all 0.2s;\n        " onmouseover="this.style.background=\'#E5E5EA\'" onmouseout="this.style.background=\'#F2F2F7\'">\n          <span style="font-size: 18px;">ğŸ”—</span>\n          å¤åˆ¶é“¾æ¥åˆ†äº«\n        </button>\n      </div>\n\n      <p style="margin: 16px 0 0 0; color: #8E8E93; font-size: 14px;">\n        æµ·æŠ¥åˆ†äº«ä¸ä¼šè¢«å¾®ä¿¡æ‹¦æˆªï¼Œæ¨èä½¿ç”¨\n      </p>\n\n      <button id="closeBtn" style="\n        position: absolute;\n        top: 12px;\n        right: 12px;\n        background: none;\n        border: none;\n        font-size: 24px;\n        color: #8E8E93;\n        cursor: pointer;\n        width: 32px;\n        height: 32px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        border-radius: 50%;\n      " onmouseover="this.style.background=\'#F2F2F7\'" onmouseout="this.style.background=\'none\'">\n        Ã—\n      </button>\n    ',s.appendChild(i),document.body.appendChild(s);const a=document.getElementById("posterShareBtn"),o=document.getElementById("templateShareBtn"),r=document.getElementById("linkShareBtn"),c=document.getElementById("closeBtn");a?.addEventListener("click",async()=>{document.body.removeChild(s),await(async()=>{if(!I){z(!0);try{const t={id:e||`news_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,title:R,summary:h.substring(0,150)+(h.length>150?"...":""),publishedAt:j,source:x},n=await T.generateSimplePoster(t);U(n,t)}catch(t){alert(A?"æµ·æŠ¥ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•":"Failed to generate poster, please try again")}finally{z(!1)}}})()}),o?.addEventListener("click",async()=>{document.body.removeChild(s),await(async()=>{if(!F){$(!0);try{const t={id:e||`news_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,title:R,content:h.length>120?h.substring(0,120)+"...":h,publishedAt:j,source:x},n=await E.generateShareImage(t);H(n,t)}catch(t){alert(A?"åˆ†äº«å›¾ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•":"Failed to generate share image, please try again")}finally{$(!1)}}})()}),r?.addEventListener("click",async()=>{navigator.clipboard&&(await navigator.clipboard.writeText(t),alert("é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼")),document.body.removeChild(s)}),c?.addEventListener("click",()=>{document.body.removeChild(s)}),s.addEventListener("click",e=>{e.target===s&&document.body.removeChild(s)});const l=guideContent.querySelector("#wechat-copy-link"),d=guideContent.querySelector("#wechat-close-guide");l?.addEventListener("click",()=>{if(navigator.clipboard)navigator.clipboard.writeText(t).then(()=>{l.textContent="å·²å¤åˆ¶!",setTimeout(()=>{document.body.removeChild(s),document.head.removeChild(style)},1e3)});else{const e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),l.textContent="å·²å¤åˆ¶!",setTimeout(()=>{document.body.removeChild(s),document.head.removeChild(style)},1e3)}}),d?.addEventListener("click",()=>{document.body.removeChild(s),document.head.removeChild(style)}),s.addEventListener("click",e=>{e.target===s&&(document.body.removeChild(s),document.head.removeChild(style))})};return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("img",{src:m||"https://news.aipush.fun/wechat-share-300.png?v=2025080702",alt:t,style:{position:"absolute",left:"-9999px",width:"300px",height:"300px",opacity:0}}),n.jsx("div",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-sm border-b border-border/50",children:n.jsx("div",{className:"max-w-4xl mx-auto px-4 py-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(o,{variant:"ghost",size:"sm",onClick:S,className:"flex items-center space-x-2",children:[n.jsx(g,{className:"w-4 h-4"}),n.jsx("span",{children:A?"è¿”å›":"Back"})]}),n.jsx("div",{className:"flex items-center space-x-2",children:n.jsxs(o,{variant:"ghost",size:"sm",onClick:D,className:"flex items-center space-x-2",children:[n.jsx(f,{className:"w-4 h-4"}),n.jsx("span",{children:A?"åˆ†äº«":"Share"})]})})]})})}),n.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 space-y-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx(r,{className:(e=>{const t=e.toLowerCase();return t.includes("ai")||t.includes("aiæ¨¡å‹")||t.includes("ai æ¨¡å‹")?"bg-gradient-ai text-white border-0":t.includes("tech")||t.includes("ç§‘æŠ€")?"bg-gradient-tech text-white border-0":t.includes("economy")||t.includes("ç»æµ")?"bg-gradient-economy text-white border-0":t.includes("analysis")||t.includes("æ·±åº¦åˆ†æ")?"bg-gradient-analysis text-white border-0":"bg-gradient-primary text-white border-0"})(v),children:v}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("h1",{className:"text-3xl font-bold leading-tight text-foreground",children:R}),!A&&k&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-2",children:n.jsx("p",{className:"text-sm text-blue-800",children:"â„¹ï¸ This content is translated from Chinese. Original English version not available."})})]}),n.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(u,{className:"w-4 h-4"}),n.jsx("span",{children:x})]}),n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(w,{className:"w-4 h-4"}),n.jsx("span",{children:P(j)})]})]})]}),n.jsx("div",{className:"overflow-hidden rounded-xl shadow-medium",children:n.jsx("img",{src:m,alt:R,className:"w-full h-64 md:h-80 object-cover"})}),n.jsx(c,{className:"bg-gradient-card border border-border/50 shadow-soft",children:n.jsx(l,{className:"p-6",children:n.jsxs("div",{className:"prose prose-lg max-w-none",children:[n.jsx("div",{className:"text-foreground leading-relaxed whitespace-pre-wrap",children:B}),h.length<200&&C&&n.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:n.jsx("p",{className:"text-sm text-blue-800",children:A?"å†…å®¹è¾ƒçŸ­ï¼Œå»ºè®®æŸ¥çœ‹åŸæ–‡è·å–å®Œæ•´ä¿¡æ¯":"Content is brief, please check the original article for complete information"})})]})})}),N&&n.jsxs(c,{className:"bg-gradient-primary/5 border border-primary/20 shadow-soft",children:[n.jsx(d,{className:"pb-3",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(y,{className:"w-5 h-5 text-primary"}),n.jsx("h3",{className:"text-lg font-semibold text-foreground",children:A?"AI è§‚ç‚¹è§£æ":"AI Analysis"})]})}),n.jsx(l,{className:"pt-0",children:n.jsx("p",{className:"text-foreground/90 leading-relaxed",children:N})})]}),n.jsx(c,{className:"bg-gradient-card border border-border/50 shadow-soft",children:n.jsx(l,{className:"p-6",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(u,{className:"w-5 h-5 text-primary"}),n.jsx("h3",{className:"text-lg font-semibold text-foreground",children:A?"æ–‡ç« æ¥æºä¿¡æ¯":"Source Information"})]}),n.jsx(p,{}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:A?"æ¥æºåª’ä½“ï¼š":"Source Media:"}),n.jsx("span",{className:"text-sm text-foreground font-medium",children:x})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:A?"APIæ¨é€ï¼š":"API Push:"}),n.jsx("span",{className:"text-sm text-foreground",children:A?"AIæ–°é—»èšåˆç³»ç»Ÿ":"AI News Aggregation"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:A?"å…è´£å£°æ˜ï¼š":"Disclaimer:"}),n.jsx("span",{className:"text-sm text-foreground",children:A?"è§‚ç‚¹ä¸ä»£è¡¨æœ¬ç«™":"Views not ours"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:A?"å‘å¸ƒæ—¶é—´ï¼š":"Published:"}),n.jsx("span",{className:"text-sm text-foreground",children:P(j)})]})]})]}),n.jsx(p,{}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[n.jsxs(o,{variant:"default",size:"lg",className:"flex items-center justify-center space-x-2 bg-blue-600 hover:bg-blue-700 text-white flex-1",onClick:()=>window.open(C,"_blank"),children:[n.jsx(u,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:A?"é˜…è¯»åŸæ–‡":"Read Original"})]}),n.jsx(o,{variant:"outline",size:"lg",className:"flex items-center justify-center space-x-2 flex-1",onClick:D,disabled:I,children:I?n.jsxs(n.Fragment,{children:[n.jsx(b,{className:"w-5 h-5 animate-spin"}),n.jsx("span",{className:"font-medium",children:A?"ç”Ÿæˆä¸­...":"Generating..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(f,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:A?"åˆ†äº«æ–‡ç« ":"Share Article"})]})})]}),n.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:n.jsx("p",{className:"text-xs text-amber-800 leading-relaxed",children:A?"å…è´£å£°æ˜ï¼šæœ¬æ–‡å†…å®¹æ¥æºäºç¬¬ä¸‰æ–¹åª’ä½“ï¼Œä¸ä»£è¡¨æœ¬å¹³å°ç«‹åœºã€‚æœ¬å¹³å°ä»…æä¾›ä¿¡æ¯å­˜å‚¨ç©ºé—´æœåŠ¡ï¼Œä¸æ‹¥æœ‰æ‰€æœ‰æƒï¼Œä¸æ‰¿æ‹…ç›¸å…³æ³•å¾‹è´£ä»»ã€‚å¦‚æ¶‰åŠç‰ˆæƒé—®é¢˜ï¼Œè¯·åŠæ—¶è”ç³»æˆ‘ä»¬ã€‚":"Disclaimer: This article content is from third-party media and does not represent the position of this platform. This platform only provides information storage space services, does not own ownership, and does not assume relevant legal responsibilities. For copyright issues, please contact us promptly."})})]})})})]})]})},I=()=>{const{id:e}=C(),t=N(),{isZh:a}=i(),[o,r]=s.useState(null),[c,l]=s.useState(!0),[d,p]=s.useState(null),[g,f]=s.useState(0),u=x(),w=o?{title:o.title,desc:o.summary||"æ¥è‡ªAIæ¨çš„æœ€æ–°èµ„è®¯",link:h(o.id),imgUrl:o.imageUrl||"https://news.aipush.fun/wechat-share-300.png?v=2025080802"}:{title:"åŠ è½½ä¸­...",desc:"æ­£åœ¨åŠ è½½æ–°é—»å†…å®¹",link:window.location.href,imgUrl:"https://news.aipush.fun/wechat-share-300.png?v=2025080802"};s.useEffect(()=>{o&&v.isWeChatEnvironment()&&v.configureShare(w)},[o]),s.useEffect(()=>{if(u&&!e&&window.location.hash){const e=window.location.hash.match(/#\/news\/(.+)/);if(e&&e[1])return void setTimeout(()=>{t(`/news/${e[1]}`,{replace:!0})},50)}},[e,u,t]),s.useEffect(()=>{(async()=>{if(!e)return p(a?"æ–°é—»IDæ— æ•ˆ":"Invalid news ID"),void l(!1);try{l(!0),p(null);const t=`?t=${Date.now()}`,n=await fetch(`/news-data.json${t}`,{method:"GET",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!n.ok)throw new Error(a?"æ— æ³•è·å–æ–°é—»æ•°æ®":"Failed to fetch news data");const s=await n.json(),i=(s.data||s).find(t=>t.id===e);if(!i)throw new Error(a?"æ–°é—»ä¸å­˜åœ¨":"News not found");r(i),f(0)}catch(t){if(u&&g<2)return void setTimeout(()=>{f(e=>e+1)},1500);p(t instanceof Error?t.message:a?"è·å–æ–°é—»å¤±è´¥":"Failed to fetch news")}finally{l(!1)}})()},[e,a,g,u]);const y=()=>{t("/")};return c?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"flex flex-col items-center space-y-4 text-muted-foreground",children:[n.jsx(j,{className:"w-8 h-8 animate-spin"}),n.jsxs("span",{className:"text-center",children:[a?"æ­£åœ¨åŠ è½½æ–°é—»...":"Loading news...",u&&g>0&&n.jsx("div",{className:"text-xs mt-2 opacity-75",children:a?`é‡è¯•ä¸­ (${g}/3)`:`Retrying (${g}/3)`})]}),u&&n.jsx("div",{className:"text-xs text-center opacity-60 max-w-xs",children:a?"å¾®ä¿¡æµè§ˆå™¨é¦–æ¬¡åŠ è½½å¯èƒ½è¾ƒæ…¢ï¼Œè¯·ç¨å€™...":"First loading in WeChat may be slow, please wait..."})]})}):d||!o?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-red-500 mb-4",children:n.jsx("p",{className:"font-semibold",children:d||(a?"æ–°é—»æœªæ‰¾åˆ°":"News not found")})}),n.jsx("button",{onClick:y,className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",children:a?"è¿”å›é¦–é¡µ":"Back to Home"})]})}):n.jsxs(n.Fragment,{children:[n.jsxs(m,{children:[n.jsxs("title",{children:[o.title," - AIæ¨"]}),n.jsx("meta",{name:"description",content:o.summary||"æœ€æ–°AIèµ„è®¯åˆ†äº«"}),n.jsx("meta",{itemProp:"name",content:o.title}),n.jsx("meta",{itemProp:"description",content:o.summary||"æœ€æ–°AIèµ„è®¯åˆ†äº«"}),n.jsx("meta",{itemProp:"image",content:o.imageUrl||"https://news.aipush.fun/wechat-share-300.png?v=2025080802"}),n.jsx("meta",{name:"wxcard:title",content:o.title}),n.jsx("meta",{name:"wxcard:desc",content:o.summary||"æ¥è‡ªAIæ¨çš„æœ€æ–°èµ„è®¯"}),n.jsx("meta",{name:"wxcard:imgUrl",content:o.imageUrl||"https://news.aipush.fun/wechat-share-300.png?v=2025080802"}),n.jsx("meta",{name:"wxcard:link",content:h(o.id)}),n.jsx("meta",{property:"og:type",content:"article"}),n.jsx("meta",{property:"og:url",content:h(o.id)}),n.jsx("meta",{property:"og:title",content:o.title}),n.jsx("meta",{property:"og:description",content:o.summary||"æœ€æ–°AIèµ„è®¯åˆ†äº«"}),n.jsx("meta",{property:"og:image",content:o.imageUrl||"https://news.aipush.fun/wechat-share-300.png?v=2025080802"}),n.jsx("meta",{property:"og:image:width",content:"300"}),n.jsx("meta",{property:"og:image:height",content:"300"}),n.jsx("meta",{property:"og:image:type",content:"image/png"}),n.jsx("meta",{property:"og:site_name",content:"AIæ¨"}),n.jsx("meta",{property:"twitter:card",content:"summary_large_image"}),n.jsx("meta",{property:"twitter:url",content:h(o.id)}),n.jsx("meta",{property:"twitter:title",content:o.title}),n.jsx("meta",{property:"twitter:description",content:o.summary||"æœ€æ–°AIèµ„è®¯åˆ†äº«"}),n.jsx("meta",{property:"twitter:image",content:o.imageUrl||"https://news.aipush.fun/wechat-share-300.png?v=2025080802"}),n.jsx("meta",{property:"article:published_time",content:o.publishedAt}),n.jsx("meta",{property:"article:author",content:o.source}),n.jsx("meta",{property:"article:section",content:o.category}),n.jsx("link",{rel:"canonical",href:`https://news.aipush.fun/news/${o.id}`}),n.jsx("meta",{name:"robots",content:"index,follow"}),n.jsx("meta",{name:"googlebot",content:"index,follow"}),u&&n.jsxs(n.Fragment,{children:[n.jsx("meta",{name:"weixin:optimized",content:"true"}),n.jsx("meta",{name:"format-detection",content:"telephone=no"}),n.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, user-scalable=no"})]})]}),n.jsx(A,{id:e,...o,onBack:y})]})};export{I as default};
