<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AIæ¨ - æ­£åœ¨è·³è½¬...</title>
  <meta name="description" content="æ­£åœ¨ä¸ºæ‚¨è·³è½¬åˆ°AIæ¨æ–°é—»é¡µé¢..." />
  
  <!-- å¾®ä¿¡ç¯å¢ƒä¼˜åŒ– -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  
  <script>
    /**
     * æ£€æµ‹å¾®ä¿¡æµè§ˆå™¨
     */
    function isWeChatBrowser() {
      return /micromessenger/i.test(navigator.userAgent);
    }
    
    /**
     * æ£€æµ‹æ˜¯å¦ä¸ºæ–°é—»è¯¦æƒ…è·¯å¾„
     */
    function isNewsDetailPath(path) {
      return /^\/news\/[^\/]+$/.test(path);
    }
    
    /**
     * ä»è·¯å¾„ä¸­æå–æ–°é—»ID
     */
    function extractNewsIdFromPath(path) {
      var match = path.match(/^\/news\/([^\/]+)$/);
      return match ? match[1] : null;
    }
    
    /**
     * æ··åˆè·¯ç”±é‡å®šå‘å¤„ç†
     */
    function handleHybridRedirect() {
      var l = window.location;
      console.log('404é¡µé¢åŠ è½½ï¼Œå½“å‰URL:', l.href);
      console.log('æ˜¯å¦å¾®ä¿¡ç¯å¢ƒ:', isWeChatBrowser());
      
      var path = l.pathname;
      var search = l.search;
      var hash = l.hash;
      
      // æ£€æŸ¥æ˜¯å¦ä¸ºæ–°é—»è¯¦æƒ…é¡µè·¯å¾„
      var newsId = extractNewsIdFromPath(path);
      
      if (isWeChatBrowser()) {
        // å¾®ä¿¡ç¯å¢ƒ - ä½¿ç”¨Hashè·¯ç”±
        if (newsId) {
          console.log('å¾®ä¿¡ç¯å¢ƒæ£€æµ‹åˆ°æ–°é—»è·¯å¾„ï¼Œæ–°é—»ID:', newsId);
          var targetUrl = '/#/news/' + newsId;
          console.log('è·³è½¬åˆ°Hash URL:', targetUrl);
          setTimeout(function() {
            window.location.replace(targetUrl);
          }, 100);
        } else if (path !== '/' && path !== '/index.html') {
          console.log('å¾®ä¿¡ç¯å¢ƒæ£€æµ‹åˆ°å…¶ä»–è·¯å¾„ï¼Œä½¿ç”¨Hashè·¯ç”±:', path);
          var targetUrl = '/#' + path + search + hash;
          console.log('è·³è½¬åˆ°Hash URL:', targetUrl);
          setTimeout(function() {
            window.location.replace(targetUrl);
          }, 100);
        } else {
          console.log('å¾®ä¿¡ç¯å¢ƒé¦–é¡µï¼Œç›´æ¥åŠ è½½åº”ç”¨');
          setTimeout(function() {
            window.location.replace('/');
          }, 100);
        }
      } else {
        // æ™®é€šç¯å¢ƒ - ä½¿ç”¨æ ‡å‡†é‡å®šå‘
        if (path !== '/' && path !== '/index.html') {
          console.log('æ™®é€šç¯å¢ƒé‡å®šå‘åˆ°index.html');
          var targetUrl = '/index.html?path=' + encodeURIComponent(path + search + hash);
          console.log('è·³è½¬åˆ°:', targetUrl);
          setTimeout(function() {
            window.location.replace(targetUrl);
          }, 100);
        } else {
          console.log('æ™®é€šç¯å¢ƒé¦–é¡µï¼Œç›´æ¥åŠ è½½åº”ç”¨');
          setTimeout(function() {
            window.location.replace('/');
          }, 100);
        }
      }
    }
    
    // æ‰§è¡Œé‡å®šå‘
    handleHybridRedirect();
  </script>
</head>
<body>
  <div style="text-align: center; padding: 50px; font-family: Arial, sans-serif;">
    <h2>ğŸ”„ æ­£åœ¨è·³è½¬...</h2>
    <p>æ­£åœ¨ä¸ºæ‚¨è·³è½¬åˆ°AIæ¨æ–°é—»é¡µé¢</p>
    <p><small>å¦‚æœé¡µé¢æ²¡æœ‰è‡ªåŠ¨è·³è½¬ï¼Œè¯·<a href="/" style="color: #0066cc;">ç‚¹å‡»è¿™é‡Œ</a></small></p>
    <div id="debug-info" style="display: none; margin-top: 20px; font-size: 12px; color: #666;">
      <p>è°ƒè¯•ä¿¡æ¯ï¼š</p>
      <p id="current-url"></p>
      <p id="browser-type"></p>
      <p id="redirect-target"></p>
    </div>
  </div>
  
  <script>
    // æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼ˆä»…åœ¨å¼€å‘ç¯å¢ƒï¼‰
    if (window.location.search.includes('debug=true')) {
      document.getElementById('debug-info').style.display = 'block';
      document.getElementById('current-url').textContent = 'å½“å‰URL: ' + window.location.href;
      document.getElementById('browser-type').textContent = 'æµè§ˆå™¨ç±»å‹: ' + (isWeChatBrowser() ? 'å¾®ä¿¡æµè§ˆå™¨' : 'æ™®é€šæµè§ˆå™¨');
    }
    
    // å¤‡ç”¨è·³è½¬æœºåˆ¶ - å¢å¼ºç‰ˆ
    setTimeout(function() {
      var currentPath = window.location.pathname;
      var currentHash = window.location.hash;
      var isWeChat = isWeChatBrowser();
      var isNewsPath = isNewsDetailPath(currentPath);
      
      console.log('å¤‡ç”¨è·³è½¬æ£€æŸ¥:', { currentPath, currentHash, isWeChat, isNewsPath });
      
      // å¦‚æœä»ç„¶åœ¨404é¡µé¢ä¸”æ²¡æœ‰è¿›è¡ŒHashè·³è½¬
      if (currentPath !== '/' && currentPath !== '/index.html' && !currentHash) {
        if (isWeChat) {
          console.log('å¾®ä¿¡ç¯å¢ƒå¤‡ç”¨è·³è½¬');
          if (isNewsPath) {
            var newsId = extractNewsIdFromPath(currentPath);
            window.location.replace('/#/news/' + newsId);
          } else {
            window.location.replace('/#' + currentPath);
          }
        } else {
          console.log('æ™®é€šç¯å¢ƒå¤‡ç”¨è·³è½¬');
          window.location.replace('/');
        }
      }
    }, 3000);
    
    // æœ€ç»ˆå¤‡ç”¨è·³è½¬
    setTimeout(function() {
      if (window.location.pathname !== '/' && !window.location.hash) {
        console.log('æœ€ç»ˆå¤‡ç”¨è·³è½¬åˆ°é¦–é¡µ');
        window.location.replace('/');
      }
    }, 5000);
  </script>
</body>
</html>